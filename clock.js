/* Digital LED or LCD Clock 2002 Â© kurt.grigg@yahoo.co.uk (updated for SVG) */

(function () {

    var clockSize = '150';
    var digitColour = 'rgba(0,100,240,1.0)';
    var digitGlowColour = 'rgba(100,180,255,1.0)';
    var digitGlowAmount = 4.0;
    var baseDigitOpacity = 0.15;
    var baseColour = 'rgba(0,0,20,1.0)';
    var caseColour = 'rgba(0,0,0,0.5)';
    var glassReflection = 'on';
        /* (on | off) On for darker LED style, off for lighter LCD style  */
        var reflectionColour = 'rgba(255,255,255,0.3)';

    /* End config */

    function encode(v) {
        return encodeURIComponent(v).replace(/'/g, "%27").replace(/"/g, "%22");
    }

    function xy (v) {
        return (v * clockSize / 100);
    }

    var d = document;
    var container, display, shine;
    var get_digit_pos = -1;
    var ini_img = [], digit_pos = [], svgDigits = [], dgts = [];
    var rnd = 'id' + d.getElementsByTagName('div').length;
    var tog = (glassReflection == 'on') ? 'block' : 'none';

    d.write('<div id="'+rnd+'"></div>');
    container = d.getElementById(rnd);

    container.setAttribute('style', 'display: inline-block;'
        +'position: relative;'
        +'width: '+xy(450)+'px;'
        +'padding-top: '+xy(6.5)+'px;padding-bottom: '+xy(6.5)+'px;'
        +'height: '+clockSize+'px;'
        +'line-height:0px;'
        +'border: '+xy(6)+'px solid '+caseColour+';'
        +'border-radius: '+xy(10)+'px;'
        +'text-align: center;' 
        +'background-color: '+baseColour+';'
        +'overflow: hidden;');

    var fltr = '<filter id="shadow">'+
    '<feGaussianBlur in="SourceAlpha" stdDeviation="'+digitGlowAmount+'"/>'+
    '<feOffset dx="0" dy="0" result="offsetblur"/>'+
    '<feFlood flood-color="'+digitGlowColour+'" flood-opacity="1.0"/>'+
    '<feComposite in2="offsetblur" operator="in"/>'+
    '<feMerge>'+
    '<feMergeNode/>'+
    '<feMergeNode in="SourceGraphic"/>'+
    '</feMerge>'+
    '</filter>';

    var theDigits = ['<path d="M 0 0 L 0 0.01953125 L 0.01953125 0.01953125 L 0.01953125 0 L 0 0 z M 64.945312 0 L 64.945312 0.01953125 L 64.966797 0.01953125 L 64.966797 0 L 64.945312 0 z M 10.794922 8.0449219 L 16.292969 13.53125 L 48.671875 13.53125 L 54.171875 8.0449219 L 10.794922 8.0449219 z M 56.353516 10.267578 L 50.865234 15.767578 L 50.865234 44.976562 L 53.609375 47.726562 L 56.353516 44.976562 L 56.353516 10.267578 z M 8.6132812 10.269531 L 8.6132812 44.976562 L 11.355469 47.726562 L 14.099609 44.976562 L 14.099609 15.765625 L 8.6132812 10.269531 z M 11.355469 52.275391 L 8.6113281 55.025391 L 8.6113281 89.730469 L 14.099609 84.230469 L 14.099609 55.025391 L 11.355469 52.275391 z M 53.609375 52.275391 L 50.865234 55.025391 L 50.865234 84.232422 L 56.351562 89.732422 L 56.351562 55.023438 L 53.609375 52.275391 z M 16.292969 86.46875 L 16.292969 86.470703 L 10.794922 91.955078 L 54.169922 91.955078 L 48.671875 86.46875 L 16.292969 86.46875 z M 0 99.980469 L 0 100 L 0.01953125 100 L 0.01953125 99.980469 L 0 99.980469 z M 64.945312 99.980469 L 64.945312 100 L 64.966797 100 L 64.966797 99.980469 L 64.945312 99.980469 z" />'
    ,'<path d="M 0 0 L 0 0.01953125 L 0.01953125 0.01953125 L 0.01953125 0 L 0 0 z M 64.945312 0 L 64.945312 0.01953125 L 64.966797 0.01953125 L 64.966797 0 L 64.945312 0 z M 56.353516 10.267578 L 50.863281 15.767578 L 50.863281 44.978516 L 53.609375 47.728516 L 56.353516 44.978516 L 56.353516 10.267578 z M 53.609375 52.275391 L 50.865234 55.025391 L 50.865234 84.232422 L 56.355469 89.732422 L 56.355469 55.021484 L 53.609375 52.275391 z M 0 99.980469 L 0 100 L 0.01953125 100 L 0.01953125 99.980469 L 0 99.980469 z M 64.945312 99.980469 L 64.945312 100 L 64.966797 100 L 64.966797 99.980469 L 64.945312 99.980469 z" />'
    ,'<path d="M 0 0 L 0 0.01953125 L 0.01953125 0.01953125 L 0.01953125 0 L 0 0 z M 64.945312 0 L 64.945312 0.01953125 L 64.966797 0.01953125 L 64.966797 0 L 64.945312 0 z M 10.794922 8.0449219 L 16.294922 13.53125 L 48.675781 13.53125 L 54.171875 8.0449219 L 10.794922 8.0449219 z M 56.353516 10.267578 L 50.865234 15.767578 L 50.865234 44.976562 L 53.609375 47.726562 L 56.353516 44.976562 L 56.353516 10.267578 z M 16.349609 47.277344 L 13.599609 50.021484 L 16.349609 52.765625 L 48.617188 52.765625 L 51.367188 50.021484 L 48.617188 47.277344 L 16.349609 47.277344 z M 11.355469 52.275391 L 8.6132812 55.025391 L 8.6132812 89.730469 L 14.099609 84.230469 L 14.099609 55.025391 L 11.355469 52.275391 z M 16.294922 86.46875 L 10.794922 91.955078 L 54.171875 91.955078 L 48.673828 86.46875 L 16.294922 86.46875 z M 0 99.980469 L 0 100 L 0.01953125 100 L 0.01953125 99.980469 L 0 99.980469 z M 64.945312 99.980469 L 64.945312 100 L 64.966797 100 L 64.966797 99.980469 L 64.945312 99.980469 z" />'
    ,'<path d="M 0 0 L 0 0.01953125 L 0.01953125 0.01953125 L 0.01953125 0 L 0 0 z M 64.945312 0 L 64.945312 0.01953125 L 64.966797 0.01953125 L 64.966797 0 L 64.945312 0 z M 10.796875 8.046875 L 16.294922 13.53125 L 48.675781 13.53125 L 54.171875 8.046875 L 10.796875 8.046875 z M 56.353516 10.269531 L 50.865234 15.767578 L 50.865234 44.978516 L 53.609375 47.728516 L 56.353516 44.978516 L 56.353516 10.269531 z M 16.349609 47.277344 L 13.599609 50.019531 L 16.349609 52.765625 L 48.617188 52.765625 L 51.367188 50.021484 L 48.617188 47.277344 L 16.349609 47.277344 z M 53.609375 52.275391 L 50.865234 55.025391 L 50.865234 84.232422 L 56.355469 89.732422 L 56.355469 55.021484 L 53.609375 52.275391 z M 16.292969 86.46875 L 16.294922 86.470703 L 10.794922 91.955078 L 54.171875 91.955078 L 48.673828 86.46875 L 16.292969 86.46875 z M 0 99.980469 L 0 100 L 0.01953125 100 L 0.01953125 99.980469 L 0 99.980469 z M 64.945312 99.980469 L 64.945312 100 L 64.966797 100 L 64.966797 99.980469 L 64.945312 99.980469 z" />'
    ,'<path d="M 0 0 L 0 0.01953125 L 0.01953125 0.01953125 L 0.01953125 0 L 0 0 z M 64.945312 0 L 64.945312 0.01953125 L 64.966797 0.01953125 L 64.966797 0 L 64.945312 0 z M 56.353516 10.267578 L 50.865234 15.767578 L 50.865234 44.976562 L 53.609375 47.726562 L 56.353516 44.976562 L 56.353516 10.267578 z M 8.6113281 10.269531 L 8.6113281 44.976562 L 11.355469 47.726562 L 14.099609 44.976562 L 14.099609 15.765625 L 8.6113281 10.269531 z M 16.349609 47.277344 L 13.599609 50.021484 L 16.349609 52.765625 L 48.615234 52.765625 L 51.365234 50.021484 L 48.615234 47.277344 L 16.349609 47.277344 z M 53.609375 52.275391 L 50.865234 55.025391 L 50.865234 84.232422 L 56.353516 89.732422 L 56.353516 55.023438 L 53.609375 52.275391 z M 0 99.980469 L 0 100 L 0.01953125 100 L 0.01953125 99.980469 L 0 99.980469 z M 64.945312 99.980469 L 64.945312 100 L 64.966797 100 L 64.966797 99.980469 L 64.945312 99.980469 z" />'
    ,'<path d="M 0 0 L 0 0.01953125 L 0.01953125 0.01953125 L 0.01953125 0 L 0 0 z M 64.945312 0 L 64.945312 0.01953125 L 64.966797 0.01953125 L 64.966797 0 L 64.945312 0 z M 10.794922 8.0449219 L 16.292969 13.53125 L 48.671875 13.53125 L 54.171875 8.0449219 L 10.794922 8.0449219 z M 8.6132812 10.269531 L 8.6132812 44.976562 L 11.355469 47.726562 L 14.099609 44.976562 L 14.099609 15.765625 L 8.6132812 10.269531 z M 16.349609 47.277344 L 13.599609 50.021484 L 16.349609 52.765625 L 48.615234 52.765625 L 51.365234 50.021484 L 48.615234 47.277344 L 16.349609 47.277344 z M 53.609375 52.275391 L 50.865234 55.025391 L 50.865234 84.232422 L 56.351562 89.732422 L 56.351562 55.023438 L 53.609375 52.275391 z M 16.292969 86.46875 L 16.292969 86.470703 L 10.794922 91.955078 L 54.169922 91.955078 L 48.671875 86.46875 L 16.292969 86.46875 z M 0 99.980469 L 0 100 L 0.01953125 100 L 0.01953125 99.980469 L 0 99.980469 z M 64.945312 99.980469 L 64.945312 100 L 64.966797 100 L 64.966797 99.980469 L 64.945312 99.980469 z" />'
    ,'<path d="M 0 0 L 0 0.01953125 L 0.01953125 0.01953125 L 0.01953125 0 L 0 0 z M 64.945312 0 L 64.945312 0.01953125 L 64.966797 0.01953125 L 64.966797 0 L 64.945312 0 z M 10.794922 8.0449219 L 16.292969 13.53125 L 48.673828 13.53125 L 54.171875 8.0449219 L 10.794922 8.0449219 z M 8.6132812 10.269531 L 8.6132812 44.976562 L 11.355469 47.726562 L 14.099609 44.976562 L 14.099609 15.765625 L 8.6132812 10.269531 z M 16.349609 47.277344 L 13.599609 50.021484 L 16.349609 52.765625 L 48.615234 52.765625 L 51.365234 50.021484 L 48.615234 47.277344 L 16.349609 47.277344 z M 11.355469 52.275391 L 8.6113281 55.025391 L 8.6113281 89.730469 L 14.099609 84.230469 L 14.099609 55.025391 L 11.355469 52.275391 z M 53.609375 52.275391 L 50.865234 55.025391 L 50.865234 84.232422 L 56.351562 89.732422 L 56.351562 55.023438 L 53.609375 52.275391 z M 16.292969 86.46875 L 16.292969 86.470703 L 10.794922 91.955078 L 54.169922 91.955078 L 48.671875 86.46875 L 16.292969 86.46875 z M 0 99.980469 L 0 100 L 0.01953125 100 L 0.01953125 99.980469 L 0 99.980469 z M 64.945312 99.980469 L 64.945312 100 L 64.966797 100 L 64.966797 99.980469 L 64.945312 99.980469 z" />'
    ,'<path d="M 0 0 L 0 0.01953125 L 0.01953125 0.01953125 L 0.01953125 0 L 0 0 z M 64.945312 0 L 64.945312 0.01953125 L 64.966797 0.01953125 L 64.966797 0 L 64.945312 0 z M 10.794922 8.0449219 L 16.294922 13.53125 L 48.673828 13.53125 L 54.171875 8.0449219 L 10.794922 8.0449219 z M 56.353516 10.269531 L 50.865234 15.765625 L 50.865234 44.976562 L 53.609375 47.726562 L 56.353516 44.976562 L 56.353516 10.269531 z M 53.609375 52.275391 L 50.865234 55.023438 L 50.865234 84.234375 L 56.353516 89.730469 L 56.353516 55.025391 L 53.609375 52.275391 z M 0 99.980469 L 0 100 L 0.01953125 100 L 0.01953125 99.980469 L 0 99.980469 z M 64.945312 99.980469 L 64.945312 100 L 64.966797 100 L 64.966797 99.980469 L 64.945312 99.980469 z" />'
    ,'<path d="M 0 0 L 0 0.01953125 L 0.01953125 0.01953125 L 0.01953125 0 L 0 0 z M 64.945312 0 L 64.945312 0.01953125 L 64.966797 0.01953125 L 64.966797 0 L 64.945312 0 z M 10.794922 8.0449219 L 16.294922 13.53125 L 48.675781 13.53125 L 54.171875 8.0449219 L 10.794922 8.0449219 z M 56.353516 10.267578 L 50.865234 15.767578 L 50.865234 44.976562 L 53.609375 47.726562 L 56.353516 44.976562 L 56.353516 10.267578 z M 8.6132812 10.269531 L 8.6132812 44.976562 L 11.355469 47.726562 L 14.099609 44.976562 L 14.099609 15.765625 L 8.6132812 10.269531 z M 16.349609 47.277344 L 13.599609 50.021484 L 16.349609 52.765625 L 48.617188 52.765625 L 51.367188 50.021484 L 48.617188 47.277344 L 16.349609 47.277344 z M 11.355469 52.275391 L 8.6132812 55.025391 L 8.6132812 89.730469 L 14.099609 84.230469 L 14.099609 55.025391 L 11.355469 52.275391 z M 53.609375 52.275391 L 50.865234 55.025391 L 50.865234 84.232422 L 56.353516 89.732422 L 56.353516 55.023438 L 53.609375 52.275391 z M 16.294922 86.46875 L 16.294922 86.470703 L 10.794922 91.955078 L 54.171875 91.955078 L 48.673828 86.46875 L 16.294922 86.46875 z M 0 99.980469 L 0 100 L 0.01953125 100 L 0.01953125 99.980469 L 0 99.980469 z M 64.945312 99.980469 L 64.945312 100 L 64.966797 100 L 64.966797 99.980469 L 64.945312 99.980469 z" />'
    ,'<path d="M 0 0 L 0 0.01953125 L 0.01953125 0.01953125 L 0.01953125 0 L 0 0 z M 64.945312 0 L 64.945312 0.01953125 L 64.966797 0.01953125 L 64.966797 0 L 64.945312 0 z M 10.794922 8.0449219 L 16.294922 13.53125 L 48.675781 13.53125 L 54.171875 8.0449219 L 10.794922 8.0449219 z M 56.353516 10.267578 L 50.865234 15.767578 L 50.865234 44.976562 L 53.609375 47.726562 L 56.353516 44.976562 L 56.353516 10.267578 z M 8.6132812 10.269531 L 8.6132812 44.976562 L 11.355469 47.726562 L 14.099609 44.976562 L 14.099609 15.765625 L 8.6132812 10.269531 z M 16.349609 47.277344 L 13.599609 50.021484 L 16.349609 52.765625 L 48.617188 52.765625 L 51.367188 50.021484 L 48.617188 47.277344 L 16.349609 47.277344 z M 53.609375 52.275391 L 50.865234 55.025391 L 50.865234 84.232422 L 56.353516 89.732422 L 56.353516 55.023438 L 53.609375 52.275391 z M 16.294922 86.46875 L 16.294922 86.470703 L 10.794922 91.955078 L 54.171875 91.955078 L 48.673828 86.46875 L 16.294922 86.46875 z M 0 99.980469 L 0 100 L 0.01953125 100 L 0.01953125 99.980469 L 0 99.980469 z M 64.945312 99.980469 L 64.945312 100 L 64.966797 100 L 64.966797 99.980469 L 64.945312 99.980469 z" />'
    ,'<path opacity="'+baseDigitOpacity+'" d="M 0 0 L 0 0.01953125 L 0.01953125 0.01953125 L 0.01953125 0 L 0 0 z M 64.945312 0 L 64.945312 0.01953125 L 64.966797 0.01953125 L 64.966797 0 L 64.945312 0 z M 10.794922 8.0449219 L 16.294922 13.53125 L 48.675781 13.53125 L 54.171875 8.0449219 L 10.794922 8.0449219 z M 56.353516 10.267578 L 50.865234 15.767578 L 50.865234 44.976562 L 53.609375 47.726562 L 56.353516 44.976562 L 56.353516 10.267578 z M 8.6132812 10.269531 L 8.6132812 44.976562 L 11.355469 47.726562 L 14.099609 44.976562 L 14.099609 15.765625 L 8.6132812 10.269531 z M 16.349609 47.277344 L 13.599609 50.021484 L 16.349609 52.765625 L 48.617188 52.765625 L 51.367188 50.021484 L 48.617188 47.277344 L 16.349609 47.277344 z M 11.355469 52.275391 L 8.6132812 55.025391 L 8.6132812 89.730469 L 14.099609 84.230469 L 14.099609 55.025391 L 11.355469 52.275391 z M 53.609375 52.275391 L 50.865234 55.025391 L 50.865234 84.232422 L 56.353516 89.732422 L 56.353516 55.023438 L 53.609375 52.275391 z M 16.294922 86.46875 L 16.294922 86.470703 L 10.794922 91.955078 L 54.171875 91.955078 L 48.673828 86.46875 L 16.294922 86.46875 z M 0 99.980469 L 0 100 L 0.01953125 100 L 0.01953125 99.980469 L 0 99.980469 z M 64.945312 99.980469 L 64.945312 100 L 64.966797 100 L 64.966797 99.980469 L 64.945312 99.980469 z" />'
    ,'<path d="M 0 0 L 0 0.0234375 L 0.0234375 0.0234375 L 0.0234375 0 L 0 0 z M 23.554688 0 L 23.554688 0.01953125 L 23.574219 0.01953125 L 23.574219 0 L 23.554688 0 z M 11.787109 32.492188 L 7.9003906 36.380859 L 11.787109 40.265625 L 15.673828 36.378906 L 11.787109 32.492188 z M 11.787109 59.732422 L 7.9003906 63.621094 L 11.787109 67.507812 L 15.673828 63.621094 L 11.787109 59.732422 z M 0 99.980469 L 0 100 L 0.01953125 100 L 0.01953125 99.980469 L 0 99.980469 z M 23.554688 99.980469 L 23.554688 100 L 23.574219 100 L 23.574219 99.980469 L 23.554688 99.980469 z" />'];

    for (var i = 0; i < 12; i++) {
        var vB = (i == 11) ? '0 0 23.574 100' : '0 0 64.966 100';
        svgDigits[i] = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="'+vB+'"><defs>'+fltr+'</defs><g fill="'+digitColour+'" filter="url(#shadow)">'+fltr+theDigits[i]+'</g></svg>';
        dgts[i] = d.createElement('img');
        dgts[i].setAttribute('src', 'data:image/svg+xml,' + encode(svgDigits[i]) );
    }


    for (var i = 0; i < 8; i++) {
        var swtch = (i == 2 || i == 5)?11:10;
            container.innerHTML+="<img id="+i+" src="+dgts[swtch].src+" height='"+clockSize+"px'>";
    }
    
    display = d.createElement('div');
    display.setAttribute('style', 'display: inline-block;'
        +'position: absolute;top: 0px;left: 0px;'
        +'height: '+clockSize+'px;'
        +'width: 100%;'
        +'padding-top: '+xy(6.5)+'px;padding-bottom: '+xy(6.5)+'px;'
        +'text-align: center;');

    for (var i = 0; i < 8; i++) {
        var colon = (i == 2 || i == 5);
        if (!colon) {
            get_digit_pos++;
        }
        ini_img[i] = (colon) ? dgts[11].src : dgts[10].src;
        digit_pos[i] = get_digit_pos;
        if (digit_pos[i] == digit_pos[i - 1]) {
            digit_pos[i] = "";
        }
        display.innerHTML += "<img id='"+rnd+digit_pos[i]+"' src="+ini_img[i]+" height='"+clockSize+"px'>";
    }
    container.appendChild(display);

    shine = d.createElement('div');
    shine.setAttribute('style', 'display: '+tog+';'
        +'position: absolute;'
        +'top: 0px;left: 0px;'
        +'height: '+(clockSize/2.5)+'px;'
        +'width: 100%;'
        +'background-color: '+reflectionColour+';'
        +'border-radius: '+xy(6)+'px '+xy(6)+'px 0 0;'
        +'box-shadow: 0 0 '+xy(5)+'px '+xy(5)+'px '+reflectionColour+';');
    display.appendChild(shine);

    function digitalclock() {
        var t = new Date();
        var s = t.getSeconds();
        var m = t.getMinutes();
        var h = t.getHours();
        var time = ((h < 10) ? "0" + h : h) + '' + ((m < 10) ?
        "0" + m : m) + '' + ((s < 10) ? "0" + s : s);
        for (var i = 0; i < time.length; i++) {
            d.images[rnd+ i].src = dgts[time.charAt(i)].src; 
        }
        setTimeout(digitalclock, 100);
    }
    window.addEventListener("load", digitalclock, false);
})();